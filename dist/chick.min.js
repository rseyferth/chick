"use strict";window.Chick=window.Chick||{},Chick.register=function(t,e,r){var i=void 0===r?e:r,n=void 0===r?!1:e;n&&(i.prototype=Object.create(n.prototype),i.prototype.constructor=i);var o=t.split("."),s=window.Chick;if(o.length>1)for(var a=0;a<o.length-1;a++)void 0===s[o[a]]&&(s[o[a]]={}),s=s[o[a]];return s[o[o.length-1]]=i||{},s[o[o.length-1]]},Chick.registerController=function(t,e){return Chick.register(t,Chick.Core.Controller,e)},Chick.knows=function(t){var e=Chick.arrayGet(Chick,t,!1);return e!==!1},Chick.promise=function(){return $.Deferred()},Chick.isPromise=function(t){return"object"==typeof t&&"function"==typeof t.then},Chick.isArray=function(t){return $.isArray(t)},Chick.when=function(t){return $.when.apply(null,t)},Chick.uuid=function(t){void 0===t&&(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx");var e=((new Date).getTime(),t.replace(/[xy]/g,function(t){var e=16*Math.random()|0,r="x"===t?e:3&e|8;return r.toString(16)}));return e},Chick.extend=function(){return $.extend.apply(this,arguments)},Chick.arrayGet=function(t,e,r,i){void 0===i&&(i=/\./),void 0===r&&(r="["+e+"]");var n=e.split(i);for(var o in n){if(void 0===t[n[o]])return r;t=t[n[o]]}return t},Chick.__contentProcessors=[],Chick.registerContentProcessor=function(t){Chick.__contentProcessors.push(t)},Chick.enableContent=function(t){for(var e in Chick.__contentProcessors)Chick.__contentProcessors[e](t)},Chick.redirect=function(t){return new Chick.Core.Redirect(t)},"function"!=typeof Object.create&&(Object.create=function(){var t=function(){};return function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");t.prototype=e;var r=new t;return t.prototype=null,r}}()),void 0===window.console&&(window.console={log:function(){},warn:function(){},error:function(){}}),function(t){function e(){}t.register("Core.TriggerClass",e),e.prototype.on=function(t,e){return this.__callbacks[t].push(e),this},e.prototype.once=function(t,e){return this.__callbacksOnce[t].push(e),this},e.prototype.trigger=function(t){var e=[];if(arguments.length>1)for(var r=1;r<arguments.length;r++)e.push(arguments[r]);var i=this;return _.each(this.__callbacks[t],function(t){t.apply(i,e)}),_.each(this.__callbacksOnce[t],function(t){t.apply(i,e)}),this.__callbacksOnce[t]=[],this},e.prototype.triggerAndReturn=function(t){var e=[];if(arguments.length>1)for(var r=1;r<arguments.length;r++)e.push(arguments[r]);var i=this,n=[];return _.each(this.__callbacks[t],function(t){n.push(t.apply(i,e))}),_.each(this.__callbacksOnce[t],function(t){n.push(t.apply(i,e))}),this.__callbacksOnce[t]=[],n.filter(function(t){return void 0!==t})},e.prototype.__registerEvents=function(t){void 0===this.__callbacks&&(this.__callbacks={}),void 0===this.__callbacksOnce&&(this.__callbacksOnce={});for(var e in t)this.__callbacks[t[e]]=[],this.__callbacksOnce[t[e]]=[]}}(Chick),function(t){function e(){}e.prototype.resolve=function(){if(this.__init(),this.__isResolved||this.__isRejected)throw new Error("A Promise can only be resolved or rejected once.");return this.__isResolved=!0,this.__result=arguments,this.__callListeners("resolve"),this},e.prototype.reject=function(){if(this.__init(),this.__isResolved||this.__isRejected)throw new Error("A Promise can only be resolved or rejected once.");return this.__isRejected=!0,this.__result=arguments,this.__callListeners("reject"),this},e.prototype.then=function(t,e){return void 0!==t&&this.__addListener("resolve",t),void 0!==e&&this.__addListener("reject",e),this},e.prototype.always=function(t){return this.__addListener("any",t),this},e.prototype.done=function(t){return this.__addListener("resolve",t),this},e.prototype.fail=function(t){return this.__addListener("reject",t),this},e.prototype.__init=function(){this.__initialized!==!0&&(this.__isResolved=!1,this.__isRejected=!1,this.__result=void 0,this.__resolveListeners=[],this.__rejectListeners=[],this.__anyListeners=[],this.__initialized=!0)},e.prototype.__callListeners=function(t){var e="resolve"===t?this.__resolveListeners:this.__rejectListeners;e=e.concat(this.__anyListeners);for(var r in e)e[r].apply(null,this.__result)},e.prototype.__addListener=function(t,e){this.__init(),this.__isResolved&&"resolve"===t||this.__isRejected&&"reject"===t||(this.__isRejected||this.__isResolved)&&"any"===t?e.apply(null,this.__result):"resolve"===t?this.__resolveListeners.push(e):"reject"===t?this.__rejectListeners.push(e):"any"===t&&this.__anyListeners.push(e)},t.register("Core.Promise",e)}(Chick),function(t){function e(){this.__init()}t.register("Core.Model",e),void 0===t.Models&&(t.Models={}),e.prototype.deserialize=function(t){_.extend(this.__attributes,t),void 0!==this.__attributes.links&&(_.extend(this.__links,this.__attributes.links),delete this.__attributes.links)},e.prototype.get=function(e){if(e.indexOf(".")>0){for(var r=this,i=e.split("."),n=/^{([a-zA-Z0-9]+)}$/,o=0;o<i.length;o++)if(n.test(i[o])){var s=n.exec(i[o])[1];"last"===s?r=t.Core.Collection.prototype.isPrototypeOf(r)?r.last():_.last(r):"first"===s?r=t.Core.Collection.prototype.isPrototypeOf(r)?r.first():_.first(r):"all"===s||(r=t.Core.Collection.prototype.isPrototypeOf(r)?r.get(s):r[s])}else{var a;if(t.isArray(r))return a=i.slice(o,i.length).join("."),_.map(r,function(t){return t.get(a)});if(t.Core.Collection.prototype.isPrototypeOf(r))return a=i.slice(o,i.length).join("."),r.map(function(t){return t.get(a)});if(void 0===r)return null;if(!t.Core.Model.prototype.isPrototypeOf(r)){r=r[i[o]];continue}r=r.get(i[o])}return r}var u="get"+inflection.camelize(e);if("function"==typeof this[u])return this[u]();if(void 0!==this.__links[e])return this.__links[e];if(void 0!==this.constructor.dates&&-1!==_.indexOf(this.constructor.dates,e))return moment(this.__attributes[e]);if(void 0!==this.constructor.embedded&&void 0!==this.constructor.embedded[e]&&!t.Core.Collection.prototype.isPrototypeOf(this.__attributes[e])){for(var c=this.__attributes[e],h=t.Models[this.constructor.embedded[e]],l=new t.Core.Collection(h),p=0;p<c.length;p++){var f=new h;f.deserialize(c[p]),l.add(f)}this.__attributes[e]=l}return this.__attributes[e]},e.prototype.each=function(e,r){var i=this.get(e);t.Core.Collection.prototype.isPrototypeOf(i)?i.each(r):_.each(i,r)},e.prototype.toArray=function(){var t=_.extend(this.__attributes);return _.each(this.__links,function(e,r){$.isArray(e)?t[r]=_.map(e,function(t){return t.toArray()}):"object"==typeof e&&(t[r]=e.toArray())}),t},e.prototype.hasLink=function(t){return void 0!==this.__links[t]},e.prototype.enrich=function(e,r){if(-1!==e.indexOf(".")){for(var i=e.split("."),n=i.pop(),o=this;i.length>0&&void 0!==o;){var s=i.shift();if("function"!=typeof o.get)return!1;if(o=o.get(s),t.Core.Collection.prototype.isPrototypeOf(o))return i.push(n),o.enrich(i.join("."),r)}e=n}if(void 0===this.__links[e])return!1;if("string"==typeof this.__links[e]||"number"==typeof this.__links[e]){var a=r.getByPK(this.__links[e]);return void(a&&(this.__links[e]=a))}this.__links[e]=_.map(this.__links[e],function(t){if("object"!=typeof t){var e=r.getByPK(t);return e?e:t}});for(var u=this.__links[e].length>0?this.__links[e][0].constructor:t.Core.Model,c=new t.Core.Collection(u),h=0;h<this.__links[e].length;h++)c.add(this.__links[e][h]);this.__links[e]=c},e.prototype.loadLink=function(e,r,i){var n=t.promise(),o=this;return t.api(r,i).then(function(t){o.__links[e]=_.keys(t.records.__recordsByPK),o.enrich(e,t.records),n.resolve()}),n},e.prototype.__init=function(){this.__primaryKey="id",this.__attributes={},this.__links={}},e.prototype.getPrimary=function(){return this.__attributes[this.__primaryKey]}}(Chick),function(t){function e(e){void 0===e&&(e=t.Core.Model),this.modelClass=e,this.__records=[],this.__recordsByPK={}}t.register("Core.Collection",e),e.prototype.add=function(t){if(e.prototype.isPrototypeOf(t)){var r=this;return void t.each(function(t){r.add(t)})}this.__records.push(t);var i=t.getPrimary();i&&(this.__recordsByPK[i]=t)},e.prototype.first=function(){return this.__records[0]||null},e.prototype.last=function(){return _.last(this.__records)},e.prototype.get=function(t){return this.__records[t]||null},e.prototype.getByPK=function(t){return this.__recordsByPK[t]||null},e.prototype.count=function(){return this.__records.length},e.prototype.each=function(t){for(var e=0;e<this.__records.length;e++)t(this.__records[e],e)},e.prototype.map=function(t){for(var e=[],r=0;r<this.__records.length;r++)e.push(t(this.__records[r],r));return e},e.prototype.list=function(t,e){for(var r,i=[],n=0;n<this.__records.length;n++)r=this.__records[n].get(t),void 0===e?i.push(r):i[this.__records[n].get(e)]=r;return i},e.prototype.find=function(t){return _.find(this.__records,t)},e.prototype.findBy=function(t,e){return _.find(this.__records,function(r){return r.get(t)===e})},e.prototype.filter=function(t){for(var r=new e(this.modelClass),i=0;i<this.__records.length;i++)if("function"==typeof t)t(this.__records[i])===!0&&r.add(this.__records[i]);else{var n=!0;for(var o in t){var s=this.__records[i].get(o);if(s!==t[o]){n=!1;break}}n&&r.add(this.__records[i])}return r},e.prototype.listUnique=function(t){return _.uniq(this.list(t))},e.prototype.sortBy=function(t){return this.__records=_.sortBy(this.__records,t),this},e.prototype.groupBy=function(t,e){if("string"==typeof t){var r=t;t=function(t){return t.get(r)}}return _.groupBy(this.__records,t,e)},e.prototype.toArray=function(){return this.__records},e.prototype.enrich=function(t,e){this.each(function(r){r.enrich(t,e)})}}(Chick),function(t){function e(){}e.prototype.setRequest=function(t){this.request=t},t.register("Core.Controller",e)}(Chick),function(t){function e(e,r){void 0===e&&(e=window.location),void 0===r&&(r=t.app.router),this.uri=null,this.data={},this.method="get",this.language=!1,this.anchor=!1,"string"!=typeof e&&(e=""+e),this.url=e,e="/"+e.replace(/^http(s)?\:\/\/[a-zA-Z\.0-9\:\-]+\//,"");var i=e.indexOf("?");if(-1!==i){var n=e.substr(i+1),o=n.split(/\&/);for(var s in o){for(var a,u=o[s].replace(/\+/g," ").split(/=/),c=decodeURIComponent(u[0]),h=decodeURIComponent(u[1]),l=/\[([a-zA-Z0-9]*)\]/g,p=this.data;null!==(a=l.exec(c));){var f=a[1],d=c.substr(0,a.index);void 0===p[d]&&(p[d]={}),p=p[d],c=f}p[c]=h}this.method="post",e=e.substr(0,i)}var _=e.split(/#/);if(_.length>1&&(e=_[0],this.anchor=_[1]),this.fullPath=e,r.baseUrl.length>0&&0===e.indexOf(r.baseUrl)&&(e=e.substr(r.baseUrl.length)),r.languageRegex!==!1){var g=r.languageRegex.exec(e);g?(this.language=g[1],e=e.substr(g[0].length)):this.language=r.settings.languages[0]}e=e.replace(/\/$/,""),this.uri=e}t.register("Core.Request",e)}(Chick),function(t){function e(e,i,n){var o=this;this.pattern=e;var s=t.extend({actions:i,parentRoute:!1,"abstract":!1},n);if(this.id=++r,this.method=s.method,this.parameterRestrictions={},this.hasRestrictions=!1,this.parentRoute=s.parentRoute,this.subRoutes=[],this.actions={},_.each(s.actions,function(e,r){if("string"==typeof e){var i=/^(\w+)@(\w+)$/.exec(e);if(!i)throw'Did not understand action "'+e+'". Use Controller@action format.';e={controller:i[1],action:i[2]}}else e=t.extend({action:"index"},e);if(void 0===e.controller)throw"A route action needs a controller at the very least. Use 'ControllerName@methodAction'.";o.actions[r]=e}),0===_.size(this.actions))throw"A route needs at least 1 action!"}var r=0;t.register("Core.Route",e),e.prototype.match=function(e){if(this["abstract"])return!1;if("string"==typeof e&&(e=new t.Core.Request(e)),e.method!==this.method)return!1;if(void 0===this.regex&&this.__createRegEx(),this.regex.test(e.uri)===!1)return!1;if(this.hasRestrictions===!1)return!0;var r=this.regex.exec(e.uri),i=r.slice(1,1+this.parameters.length);for(var n in this.parameters){var o=this.parameterRestrictions[this.parameters[n]];if(void 0!==o)for(var s in o)if(o[s].test(i[n])===!1)return!1}return!0},e.prototype.getActions=function(){return this.parentRoute===!1?this.actions:_.extend(this.parentRoute.getActions(),this.actions)},e.prototype.getActionQueue=function(t){for(var e=this,r=[];e!==!1;)r.unshift(e),e=e.parentRoute;for(var i={},n=0;n<r.length;n++)e=r[n],_.each(e.actions,function(r,n){var o=t.slice(0,e.parameters.length);i[n]={route:e,routeParams:o,key:n,action:r}});return i},e.prototype.execute=function(e){var r=this;if("string"==typeof e&&(e=new t.Core.Request(e)),e.method!==this.method)return!1;var i=this.regex.exec(e.uri),n=i.slice(1,1+this.parameters.length),o=Chick.promise(),s=t.app.router.controllerNamespace;s=s?s+".":"";var a={},u=this.getActionQueue(n),c=_.keys(u),h=function(){if(0===c.length)return console.log(a),void o.resolve(a);var i=c.shift(),n=u[i],l=n.action,p=t.app.getViewContainer(n.key);if(0!==c.length&&p.isLastSetBy(n.route,n.routeParams))return void h();var f=s+l.controller,d=Chick.arrayGet(Chick,f,null);if(!d)throw"There is no controller defined as "+f;var _=new d;if(_.setRequest(e),void 0===_[l.action])throw"The controller does not have a method "+l.action;var g=_[l.action].apply(_,n.routeParams);r.__processResponse(i,g).then(function(e){a[i]=g,t.app.router.trigger("actionComplete",[i,e,this]),p.setContent(e,n.route,n.routeParams),h()})};return h(),o},e.prototype.leave=function(t){return this.view?this.view.leave(t):!0},e.prototype.having=function(t,e){return void 0===this.parameterRestrictions[t]&&(this.parameterRestrictions[t]=[]),this.parameterRestrictions[t].push(e),this.hasRestrictions=!0,this},e.prototype.sub=function(e){var r=this,i={get:function(e,i,n){return void 0===n&&(n={}),n.parentRoute=r,t.app.router.get(e,i,n)},post:function(e,i,n){return void 0===n&&(n={}),n.parentRoute=r,t.app.router.post(e,i,n)}};e.apply(i)},e.prototype.__processResponse=function(e,r,i){if(void 0===i&&(i=t.promise()),r===!1)i.reject(404);else if(t.knows("Gui.View")&&t.Gui.View.prototype.isPrototypeOf(r))this.view=r,this.view.render().then(function(t){i.resolve(t)});else if(t.Core.Redirect.prototype.isPrototypeOf(r))t.app.router.open(r.url);else if("object"==typeof r&&"function"==typeof r.then){var n=this;r.then(function(t){n.__processResponse(e,t,i)})}else i.resolve(r);return i},e.prototype.__getPattern=function(){for(var t=this.pattern,e=this.parentRoute;e!==!1;)t=e.pattern+t,e=e.parentRoute;return t},e.prototype.__createRegEx=function(){var t=[],e=this.__getPattern().replace(/\/:([a-zA-Z]+)/g,function(e){return t.push(e.replace(/\/:/,"")),"/([-a-zA-Z0-9,]+)"}).replace(/\/{([a-zA-Z]+)}/g,function(e){return t.push(e.replace(/\/:/,"")),"/([-a-zA-Z0-9,]+)"}).replace(/\/\#([a-zA-Z]+)/g,function(e){return t.push(e.replace(/\/:/,"")),"/([0-9]+)"});e=e.replace(/\/$/,""),e=e.replace(/\//g,"\\/"),this.regex=new RegExp("^"+e+"$"),this.parameters=t}}(Chick),function(t){function e(e){this.__registerEvents(["navigationStart","navigationComplete","error","pageNotFound","selectLanguage","actionComplete"]),this.settings=t.extend({baseUrl:"/",catchLinks:!0,catchForms:!0,controllerNamespace:null},e),this.baseUrl=this.settings.baseUrl.replace(/\/$/,""),this.languageRegex=!1,this.controllerNamespace=this.settings.controllerNamespace,this.routes=[],this.activeRoute=null;var r=this;History.Adapter.bind(window,"statechange",function(){var t=History.getState();r["goto"](t.cleanUrl)}),this.settings.catchLinks&&t.registerContentProcessor(function(t){var e=t.find("a").not('[href^="http"]').not('[href^="#"]').not('[href^="//"]');e.on("click",function(t){t.preventDefault(),History.pushState(null,null,r.baseUrl+$(this).attr("href"))})}),this.settings.catchForms&&t.registerContentProcessor(function(t){t.find("form").not('[action^="http"]').on("submit",function(t){var e=$(this);t.preventDefault();var r=function(t){History.pushState(null,null,e.attr("action")+"?"+e.serialize())};e.on("formSubmit",r),e.trigger("formSubmit"),e.off("formSubmit",r)})})}t.register("Core.Router",t.Core.TriggerClass,e),e.prototype.get=function(t,e,r){return void 0===r&&(r={}),r.method="get",this.add(t,e,r)},e.prototype.post=function(t,e,r){return void 0===r&&(r={}),r.method="post",this.add(t,e,r)},e.prototype.detectLanguage=function(){var e=new t.Core.Request;return e.language},e.prototype.languages=function(t){return this.settings.languages=t,t===!1?this.languageRegex=!1:this.languageRegex=new RegExp("/("+t.join("|")+")"),this},e.prototype.add=function(e,r,i){var n=new t.Core.Route(e,r,i);return this.routes.push(n),n.parentRoute!==!1&&n.parentRoute.subRoutes.push(n),n},e.prototype.open=function(t){return History.pushState(null,null,t),this},e.prototype.redirect=function(t){return History.replaceState(null,null,t),this},e.prototype.switchLanguage=function(t){var e=this.lastRequest,r=e.url.replace("/"+e.language+"/","/"+t+"/");return""===e.uri&&(r="/"+t),this["goto"](r)},e.prototype["goto"]=function(e){var r=t.Core.Request.prototype.isPrototypeOf(e)?e:new t.Core.Request(e),i=this;if(this.lastRequest=r,r.language!==!1&&r.language!==t.app.language){if(this.settings.refreshOnLanguageSwitch)return void(window.location=r.url);this.trigger("selectLanguage",r.language)}var n=t.promise();if(this.activeRoute){var o=this.activeRoute.leave(r);if(o===!1)return;t.isPromise(o)?o.then(function(){n.resolve()}):n.resolve()}else n.resolve();n.then(function(){i.trigger("pageLoadStart",r.uri,r);var t=!1;for(var e in i.routes)if(i.routes[e].match(r)){t=i.routes[e];break}t===!1?(i.trigger("error",404),i.trigger("pageNotFound")):(i.activeRoute=t,t.execute(r).then(function(t){i.trigger("navigationComplete",t)}).fail(function(t){i.trigger("error",t)}))})},e.prototype.start=function(){var t=History.getState();return this["goto"](t.cleanUrl)}}(Chick),function(t){function e(t){this.url=t}t.register("Core.Redirect",e)}(Chick);var ns=Chick.register("Net.Api",{config:{baseUrl:"/api/v1",key:"",urlSuffix:""},configure:function(t){return _.extend(this.config,t)},call:function(t,e,r,i){return new Chick.Net.ApiCall(t,e,r,i)},createUrl:function(t){var e=this.config.baseUrl+t+this.config.urlSuffix;return e},cache:function(t,e,r){if(void 0===e){if(e=localStorage["Chick-api-cache."+t],!e)return;var i=moment(),n=moment(e.substr(0,moment().format().length));if(n.isValid()===!1)return;if(i.unix()>n.unix())return;return e.substr(moment().format().length)}void 0===r?r=moment().add(24,"hours"):"number"==typeof r&&(r=moment().add(r,"seconds")),e=r.format()+e,localStorage["Chick-api-cache."+t]=e}});Chick.api=function(){return ns.call.apply(ns,arguments)},function(t){function e(r,i,n,o){var s=null;"string"==typeof i?r+="/"+r:"object"==typeof i&&(void 0!==i.include&&"string"!=typeof i.include&&(i.include=i.include.join(",")),s=i);var a=t.Net.Api.createUrl(r);n=_.extend({type:"get",data:s||{},url:a,headers:{"X-Api-Key":t.Net.Api.config.key}},n||{}),o=_.extend({allowCache:!1,cacheExpire:void 0,model:!1,handleErrors:!0},o||{});var u=this;if(o.allowCache===!0){var c=n.type.toUpperCase()+" "+a+"?"+$.param(n.data),h=t.Net.Api.cache(c);if(void 0!==h){var l=new t.Net.ApiResult($.parseJSON(h),r,{model:o.model});return void u.resolve(l,h)}}$.support.cors===!1&&(n.dataType="jsonp",n.data.alt="jsonp",n.data.api_key=t.Net.Api.config.key),this.ajaxCall=$.ajax(n).done(function(e,i,n){var s=new t.Net.ApiResult(e,r,{model:o.model});u.resolve(s,n.responseText),o.allowCache===!0&&t.Net.Api.cache(c,n.responseText,o.cacheExpire)}).fail(function(t){u.reject(t),o.handleErrors!==!1&&e.any.trigger("error",t)})}t.register("Net.ApiCall",t.Core.Promise,e),e.prototype.abort=function(){return this.ajaxCall.abort(),this},e.any=new t.Core.TriggerClass,e.any.__registerEvents(["error"])}(Chick),function(t){function e(t,e,r){this.meta=t.meta,delete t.meta,void 0!==t.linked&&(this.linked=this.__deserializeLinked(t.linked),delete t.linked),this.linkInfo=!1,void 0!==t.links&&(this.linkInfo=t.links,delete t.links);var i=_.extend({model:!1},r);this.rootElement=_.first(_.keys(t)),this.records=this.__deserialize(t[this.rootElement],i.model?i.model:inflection.classify(this.rootElement)),this.linkInfo&&this.__enrichLinks()}t.register("Net.ApiResult",e),e.prototype.each=function(t){return this.records.each(t)},e.prototype.__deserialize=function(e,r){var i="function"==typeof t.Models[r]?t.Models[r]:t.Core.Model,n=new t.Core.Collection(i);return _.each(e,function(t){var e=new i;e.deserialize(t),n.add(e)}),n},e.prototype.__deserializeLinked=function(t){var e={},r=this;return _.each(t,function(t,i){e[i]=r.__deserialize(t,inflection.classify(i))}),e},e.prototype.__enrichLinks=function(){for(var t in this.linkInfo){var e=this.linkInfo[t];if(void 0!==e.type&&void 0!==this.linked[e.type]){var r=t.split("."),i=r[0],n=(r.shift(),r.join("."));i===this.rootElement&&this.records.enrich(n,this.linked[e.type]),void 0!==this.linked[i]&&this.linked[i].enrich(n,this.linked[e.type])}}}}(Chick),function(t){var e=t.register("Gui.I18n");e.language=$("html").attr("lang")||"en",e.baseUrl="lang/:lang/",e.data={},e.numbers={decimal:".",thousands:",",thousandsLength:3,currency:{precision:2}},e.setBaseUrl=function(t){/\/$/.test(t)||(t+="/"),e.baseUrl=t},e.setLanguage=function(t){e.language=t,moment.locale(t)},e.currencyFormat=function(t){return e.numberFormat(t,e.numbers.currency.precision)},e.numberFormat=function(t,r){var i=t.toFixed(r),n=i.split(".");if(n[0].length>e.numbers.thousandsLength){for(var o=/(\d+)(\d{3})/,s=n[0];o.test(s);)s=s.replace(o,"$1"+e.numbers.thousands+"$2");i=s+e.numbers.decimal+n[1]}else i=i.replace(".",e.numbers.decimal);return i},e.switchLanguage=function(t){e.language=t,e.apply()},e.apply=function(t){void 0===t&&(t=$("html")),t.find("[data-i18n]").each(function(t){var r=$(this),i=r.data("i18n").split(",");for(var n in i){var o=i[n].split(":");1===o.length?r.text(e.get(o[0])):r.attr(o[0],o[1])}})},e.replaceLocations=function(t){var r=e.get("locations.abbreviations");for(var i in r){var n=new RegExp(i,"gi");t=t.replace(n,r[i])}return t},e.load=function(r,i,n){void 0===i&&(i=e.language);var o=e.baseUrl.replace(":lang",i)+r+".json";moment.locale(i);var s=t.promise();return $.ajax({url:o}).then(function(r){var i=e.data;void 0!==n&&(i=i[n]),i=t.extend(i,r),void 0!==i.numbers&&(e.numbers=t.extend(e.numbers,i.numbers)),s.resolve(r)}),s},e.get=function(r,i){var n=t.arrayGet(e.data,r,!1);return n?(void 0!==i&&("string"==typeof i?n=n.replace(/\:[a-zA-Z]+/,i):"object"==typeof i&&_.each(i,function(t,e){n=n.replace(":"+e,t)})),n):"["+r+"]"},window.trans=e.get,window.I18n=e}(Chick),function(t){function e(t,e){this.run=_.template(t,e)}t.register("Gui.Template",e),e.prototype.use=function(t,e){return e.html(this.run(t)),e},t.template=function(t,r,i){var n=new e(t);return void 0===i?n.run(r):n.use(r,i)}}(Chick),function(t){function e(t,e,r){this.method=void 0===e?"get":e,this.requestData=void 0===r?{}:r,this.source=t,this.data={},this.template=null,this.__loadPromise=void 0,this.__waitFor=[],this.__waitForLeaveAnimation=!1,this.$element=$('<div class="view"></div>').addClass(inflection.dasherize(t).split("/").join("-")),this.__registerEvents(["ready","leave","render"])}t.register("Gui.View",t.Core.TriggerClass,e),e.prototype.preloadImage=function(e){var r=t.promise();return $("<img/>").on("load",function(){r.resolve()}).on("error",function(){throw r.resolve(),"Could not find image: "+e}).attr("src",e),this.__waitFor.push(r),this},e.prototype.preloadImages=function(t){for(var e in t)this.preloadImage(t[e]);return this},e.prototype.withJson=function(e,r){var i=e,n=!1;void 0!==r&&(i=r,n=e);var o=t.promise(),s=this;return $.ajax({url:i}).then(function(t){n?s.data[n]=t:s.data=t,o.resolve()}),this.__waitFor.push(o),this},e.prototype.withData=function(e,r,i){var n=e,o=!1;void 0!==r&&(n=r,o=e);var s=t.promise();"object"==typeof n&&"function"==typeof n.then?(n.then(function(t){i?i(s,t):s.resolve(t)}),this.__waitFor.push(s)):s.resolve(n);var a=this;return s.then(function(t){o?a.data[o]=t:a.data=t}),this},e.prototype.withCollection=function(e,r,i){var n=this;return this.withData(e,r,function(e,r){var o=r.records;if(void 0!==i){var s=i.apply(n,[o]);if(s===!1)return void t.app.abort(404);void 0!==s&&(o=s)}e.resolve(o)})},e.prototype.withModel=function(e,r,i){return this.withData(e,r,function(e,r){var n=r.records.first();if(n){if(void 0!==i){var o=i(n);void 0!==o&&(n=o)}e.resolve(n)}else t.app.abort(404)})},e.prototype.load=function(){if(void 0!==this.__loadPromise)return this.__loadPromise;this.__loadPromise=t.promise(),this.__waitFor.push(this.__loadPromise);var r=this;return $.ajax({url:e.path+this.source+e.defaultSuffix,data:this.requestData,method:this.method}).then(function(e){r.template=new t.Gui.Template(e),r.__loadPromise.resolve()}).fail(function(t){}),this.__loadPromise},e.prototype.render=function(){this.trigger("render"),e.any.trigger("render",this);var r=t.promise();this.load();var i=this;return t.when(this.__waitFor).then(function(){i.$element.html(i.template.run(i.data)),t.enableContent(i.$element),r.resolve(i.$element),i.trigger("ready"),e.any.trigger("ready",i)}),r},e.prototype.waitForLeaveAnimation=function(t){return this.__waitForLeaveAnimation=void 0===t?!0:t,this},e.prototype.leave=function(r){var i=this.triggerAndReturn("leave",r);if(e.any.trigger("leave",this,r),i.length>0){for(var n=[],o=0;o<i.length;o++){if(i[o]===!1)return!1;t.isPromise(i[o])&&n.push(i[o])}if(n.length>0){if(1===n.length)return n[0];t.promise();return t.when(n)}}return!0},e.make=function(t,r,i){var n=new e(t,r,i);return n},e.any=new Chick.Core.TriggerClass,e.any.__registerEvents(["ready","leave","render"]),e.path="views/",e.defaultSuffix=".jt"}(Chick),function(t){function e(t,e){this.name=t,this.$target=e,this.lastSetByRoute=!1,this.lastSetByRouteParams=!1}t.register("Gui.ViewContainer",t.Core.TriggerClass,e),e.prototype.setTarget=function(t){t[0]!==this.$target[0]&&(this.$target=t,this.lastSetByRoute=!1,this.lastSetByRouteParams=!1)},e.prototype.setContent=function(t,e,r){this.lastSetByRoute=e,this.lastSetByRouteParams=r,this.$target.html(t),Chick.enableContent(this.$target),Chick.app.findViewContainers()},e.prototype.isLastSetBy=function(t,e){return this.lastSetByRoute===!1?!1:t.id===this.lastSetByRoute.id&&JSON.stringify(e)===JSON.stringify(this.lastSetByRouteParams)?!0:!1}}(Chick),function(t){function e(e,r){this.__registerEvents(["resize","ready"]);this.$app=e,this.settings=t.extend(!0,{baseUrl:"/",i18n:{bundles:[]},languageInUrl:!0,debug:!0},r),this.readyPromises=[],this.__errorHandlers={},this.$window=$(window),this.$body=$("body"),this.$container=this.$app.parent(),this.$document=$(document),this.viewContainers={},this.router=new t.Core.Router({baseUrl:this.settings.baseUrl}),this.__createListeners(),this.__onResize(),t.app=this,this.findViewContainers()}t.register("Gui.App",t.Core.TriggerClass,e),e.prototype.start=function(){var e=this,r=e.router.detectLanguage();if(r!==!1&&(t.Gui.I18n.setLanguage(r),t.app.language=r),this.settings.i18n.bundles.length>0)for(var i in this.settings.i18n.bundles)this.readyPromises.push(t.Gui.I18n.load(this.settings.i18n.bundles[i]));return t.when(this.readyPromises).then(function(){e.settings.i18n.bundles.length>0&&t.Gui.I18n.apply($("html")),e.trigger("ready"),e.router.start(),e.__onResize()}),this},e.prototype.findViewContainers=function(t){var e=this;void 0===t&&(t=this.$body);var r={};t.find("view, [view]").each(function(t,e){var i=$(e),n=i.is("view")?i.attr("name"):i.attr("view");if(!n)throw"RoutingError: You need to define the name attribute for each <view>.";r[n]=i}),_.each(_.difference(_.keys(this.viewContainers),_.keys(r)),function(t){delete e.viewContainers[t]}),_.each(r,function(t,r){void 0===e.viewContainers[r]?e.viewContainers[r]=new Chick.Gui.ViewContainer(r,t):e.viewContainers[r].setTarget(t)})},e.prototype.getViewContainer=function(t){if(void 0===this.viewContainers[t])throw'RoutingError: Unknown view container "'+t+'"';return this.viewContainers[t]},e.prototype.ready=function(t){var e=this;return this.__promiseReady.then(function(){t.apply(e)}),this},e.prototype.routes=function(t){return t.apply(this.router),this},e.prototype.errors=function(e){return this.__errorHandlers=t.extend(this.__errorHandlers,e),this},e.prototype.handleError=function(t,e){if(void 0!==this.__errorHandlers[t]){this.__errorHandlers[t](e);throw"ERROR HANDLING NOT IMPLEMENTED: "+t+": "+e}this["interface"].setContent("Error "+t)},e.prototype.abort=function(t,e){return this.handleError(t,e)},e.prototype.isMobile=function(){return window.innerWidth<750},e.prototype.switchLanguage=function(t){this.router.switchLanguage(t)},e.prototype.__createListeners=function(){var t,e,r=this,i=!1;window.setInterval(function(){var n=!1;window.innerWidth!==t&&(t=window.innerWidth,n=!0),window.innerHeight!==e&&(e=window.innerHeight,n=!0),n&&(i!==!1&&window.clearTimeout(i),i=window.setTimeout(function(){r.__onResize(),i=!1},50))},25),this.router.on("error",function(t){r.handleError(t)})},e.prototype.__onResize=function(){var t=this;t.trigger("resize")},t.createApplication=function(e,r){var i=new t.Gui.App(e,r);return i},t.url=function(e){"#"===e[0]&&(e=t.app.router.lastRequest.uri+e);var r=t.app.settings.baseUrl;return"/"===r&&(r=""),void 0!==t.app.language&&t.app.settings.languageInUrl===!0&&(r=r+"/"+t.app.language),r+e}}(Chick);